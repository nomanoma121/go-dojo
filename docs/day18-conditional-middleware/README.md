# Day 18: Conditional Middleware

## üéØ Êú¨Êó•„ÅÆÁõÆÊ®ô (Today's Goal)

Êù°‰ª∂„Å´Âü∫„Å•„ÅÑ„Å¶„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÇíÂãïÁöÑ„Å´ÈÅ©Áî®„ÉªÈô§Â§ñ„Åô„Çã„Ç∑„Çπ„ÉÜ„É†„ÇíÂÆüË£Ö„Åó„ÄÅÊüîËªü„Åß„Çπ„Ç±„Éº„É©„Éñ„É´„Å™HTTP„Éü„Éâ„É´„Ç¶„Çß„Ç¢„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÇíÁøíÂæó„Åô„Çã„ÄÇÁí∞Â¢É„ÄÅ„Éë„Çπ„ÄÅ„Éò„ÉÉ„ÉÄ„Éº„ÄÅ„É¶„Éº„Ç∂„ÉºÊ®©Èôê„Å™„Å©„ÅÆÊù°‰ª∂„Å´Âøú„Åò„ÅüÈÅ©ÂøúÁöÑ„Å™Âá¶ÁêÜ„ÇíÂÆüÁèæ„Åô„Çã„ÄÇ

## üìñ Ëß£Ë™¨ (Explanation)

### Conditional Middleware„Å®„ÅØ

Conditional MiddlewareÔºàÊù°‰ª∂‰ªò„Åç„Éü„Éâ„É´„Ç¶„Çß„Ç¢Ôºâ„ÅØ„ÄÅÁâπÂÆö„ÅÆÊù°‰ª∂„ÅåÊ∫Ä„Åü„Åï„Çå„ÅüÂ†¥Âêà„Å´„ÅÆ„ÅøÂÆüË°å„Åï„Çå„Çã„Éü„Éâ„É´„Ç¶„Çß„Ç¢„Éë„Çø„Éº„É≥„Åß„Åô„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅ„É™„ÇØ„Ç®„Çπ„Éà„ÅÆÁâπÊÄß„Å´Âøú„Åò„Å¶Áï∞„Å™„ÇãÂá¶ÁêÜ„ÉÅ„Çß„Éº„É≥„ÇíÂãïÁöÑ„Å´ÊßãÁØâ„Åß„Åç„Åæ„Åô„ÄÇ

### ÂÆüÁî®ÁöÑ„Å™„É¶„Éº„Çπ„Ç±„Éº„Çπ

#### 1. Áí∞Â¢ÉÂõ∫Êúâ„ÅÆÂá¶ÁêÜ

```go
// ÈñãÁô∫Áí∞Â¢É„Åß„ÅÆ„Åø„Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±„ÇíÂá∫Âäõ
func DevOnlyMiddleware(handler http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        if os.Getenv("ENV") == "development" {
            log.Printf("DEBUG: %s %s", r.Method, r.URL.Path)
        }
        handler.ServeHTTP(w, r)
    })
}
```

#### 2. „Éë„ÇπÂõ∫Êúâ„ÅÆË™çË®º

```go
// ÁâπÂÆö„ÅÆ„Éë„Çπ„Åß„ÅÆ„ÅøË™çË®º„ÇíË¶ÅÊ±Ç
func ConditionalAuthMiddleware(authPaths []string) func(http.Handler) http.Handler {
    return func(next http.Handler) http.Handler {
        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
            for _, path := range authPaths {
                if strings.HasPrefix(r.URL.Path, path) {
                    // Ë™çË®º„ÉÅ„Çß„ÉÉ„ÇØ
                    if !isAuthenticated(r) {
                        http.Error(w, "Unauthorized", http.StatusUnauthorized)
                        return
                    }
                    break
                }
            }
            next.ServeHTTP(w, r)
        })
    }
}
```

#### 3. „É¶„Éº„Ç∂„ÉºÊ®©Èôê„Éô„Éº„Çπ

```go
// ÁÆ°ÁêÜËÄÖÊ®©Èôê„ÅåÂøÖË¶Å„Å™„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà
func AdminOnlyMiddleware(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        user := getUserFromContext(r.Context())
        if user == nil || !user.IsAdmin {
            http.Error(w, "Admin access required", http.StatusForbidden)
            return
        }
        next.ServeHTTP(w, r)
    })
}
```

### È´òÂ∫¶„Å™Conditional Middleware„Éë„Çø„Éº„É≥

#### 1. „É´„Éº„É´„Éô„Éº„Çπ„Éü„Éâ„É´„Ç¶„Çß„Ç¢

```go
type MiddlewareRule struct {
    Condition func(*http.Request) bool
    Middleware func(http.Handler) http.Handler
}

type ConditionalMiddleware struct {
    rules []MiddlewareRule
}

func NewConditionalMiddleware() *ConditionalMiddleware {
    return &ConditionalMiddleware{
        rules: make([]MiddlewareRule, 0),
    }
}

func (cm *ConditionalMiddleware) AddRule(condition func(*http.Request) bool, middleware func(http.Handler) http.Handler) {
    cm.rules = append(cm.rules, MiddlewareRule{
        Condition: condition,
        Middleware: middleware,
    })
}

func (cm *ConditionalMiddleware) Apply(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // ÈÅ©Áî®ÂèØËÉΩ„Å™„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÇíÂèéÈõÜ
        var applicableMiddlewares []func(http.Handler) http.Handler
        
        for _, rule := range cm.rules {
            if rule.Condition(r) {
                applicableMiddlewares = append(applicableMiddlewares, rule.Middleware)
            }
        }
        
        // „Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÉÅ„Çß„Éº„É≥„ÇíÊßãÁØâ
        handler := next
        for i := len(applicableMiddlewares) - 1; i >= 0; i-- {
            handler = applicableMiddlewares[i](handler)
        }
        
        handler.ServeHTTP(w, r)
    })
}
```

#### 2. Ë§áÈõë„Å™Êù°‰ª∂Âºè

```go
type RequestCondition interface {
    Matches(*http.Request) bool
}

type PathCondition struct {
    Pattern string
}

func (pc *PathCondition) Matches(r *http.Request) bool {
    matched, _ := regexp.MatchString(pc.Pattern, r.URL.Path)
    return matched
}

type MethodCondition struct {
    Methods []string
}

func (mc *MethodCondition) Matches(r *http.Request) bool {
    for _, method := range mc.Methods {
        if r.Method == method {
            return true
        }
    }
    return false
}

type HeaderCondition struct {
    Header string
    Value  string
}

func (hc *HeaderCondition) Matches(r *http.Request) bool {
    return r.Header.Get(hc.Header) == hc.Value
}

type AndCondition struct {
    Conditions []RequestCondition
}

func (ac *AndCondition) Matches(r *http.Request) bool {
    for _, condition := range ac.Conditions {
        if !condition.Matches(r) {
            return false
        }
    }
    return true
}

type OrCondition struct {
    Conditions []RequestCondition
}

func (oc *OrCondition) Matches(r *http.Request) bool {
    for _, condition := range oc.Conditions {
        if condition.Matches(r) {
            return true
        }
    }
    return false
}
```

#### 3. ÂãïÁöÑ„Éü„Éâ„É´„Ç¶„Çß„Ç¢Ë®≠ÂÆö

```go
type DynamicMiddlewareConfig struct {
    mu          sync.RWMutex
    configs     map[string]MiddlewareConfig
    subscribers []chan<- MiddlewareUpdate
}

type MiddlewareConfig struct {
    Enabled    bool                          `json:"enabled"`
    Conditions map[string]interface{}        `json:"conditions"`
    Settings   map[string]interface{}        `json:"settings"`
}

type MiddlewareUpdate struct {
    Type   string
    Config MiddlewareConfig
}

func (dmc *DynamicMiddlewareConfig) UpdateConfig(middlewareType string, config MiddlewareConfig) {
    dmc.mu.Lock()
    defer dmc.mu.Unlock()
    
    dmc.configs[middlewareType] = config
    
    // Ë®≠ÂÆöÂ§âÊõ¥„ÇíÈÄöÁü•
    update := MiddlewareUpdate{
        Type:   middlewareType,
        Config: config,
    }
    
    for _, subscriber := range dmc.subscribers {
        select {
        case subscriber <- update:
        default:
            // „Éé„É≥„Éñ„É≠„ÉÉ„Ç≠„É≥„Ç∞ÈÄÅ‰ø°
        }
    }
}

func (dmc *DynamicMiddlewareConfig) GetConfig(middlewareType string) (MiddlewareConfig, bool) {
    dmc.mu.RLock()
    defer dmc.mu.RUnlock()
    
    config, exists := dmc.configs[middlewareType]
    return config, exists
}

func (dmc *DynamicMiddlewareConfig) Subscribe() <-chan MiddlewareUpdate {
    dmc.mu.Lock()
    defer dmc.mu.Unlock()
    
    ch := make(chan MiddlewareUpdate, 10)
    dmc.subscribers = append(dmc.subscribers, ch)
    return ch
}
```

#### 4. A/B„ÉÜ„Çπ„ÉàÁî®„Éü„Éâ„É´„Ç¶„Çß„Ç¢

```go
type ABTestMiddleware struct {
    testName     string
    variantRatio float64 // 0.0-1.0
    variantMiddleware func(http.Handler) http.Handler
    controlMiddleware func(http.Handler) http.Handler
}

func NewABTestMiddleware(testName string, variantRatio float64, 
    variant, control func(http.Handler) http.Handler) *ABTestMiddleware {
    return &ABTestMiddleware{
        testName:          testName,
        variantRatio:      variantRatio,
        variantMiddleware: variant,
        controlMiddleware: control,
    }
}

func (ab *ABTestMiddleware) Apply(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // „É¶„Éº„Ç∂„ÉºID„Éô„Éº„Çπ„Åß„Éê„É™„Ç¢„É≥„ÉàÊ±∫ÂÆö
        userID := getUserID(r)
        hash := hashString(userID + ab.testName)
        
        var middleware func(http.Handler) http.Handler
        if hash < ab.variantRatio {
            middleware = ab.variantMiddleware
            w.Header().Set("X-AB-Test-Variant", "B")
        } else {
            middleware = ab.controlMiddleware
            w.Header().Set("X-AB-Test-Variant", "A")
        }
        
        w.Header().Set("X-AB-Test-Name", ab.testName)
        middleware(next).ServeHTTP(w, r)
    })
}

func hashString(s string) float64 {
    h := fnv.New32a()
    h.Write([]byte(s))
    return float64(h.Sum32()) / float64(^uint32(0))
}
```

#### 5. Ê©üËÉΩ„Éï„É©„Ç∞„Å®„ÅÆÁµ±Âêà

```go
type FeatureFlaggedMiddleware struct {
    flagName   string
    flagClient FeatureFlagClient
    middleware func(http.Handler) http.Handler
    fallback   func(http.Handler) http.Handler
}

type FeatureFlagClient interface {
    IsEnabled(flagName, userID string) bool
}

func NewFeatureFlaggedMiddleware(flagName string, client FeatureFlagClient,
    middleware, fallback func(http.Handler) http.Handler) *FeatureFlaggedMiddleware {
    return &FeatureFlaggedMiddleware{
        flagName:   flagName,
        flagClient: client,
        middleware: middleware,
        fallback:   fallback,
    }
}

func (ffm *FeatureFlaggedMiddleware) Apply(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        userID := getUserID(r)
        
        var middleware func(http.Handler) http.Handler
        if ffm.flagClient.IsEnabled(ffm.flagName, userID) {
            middleware = ffm.middleware
            w.Header().Set("X-Feature-Flag", "enabled")
        } else {
            middleware = ffm.fallback
            w.Header().Set("X-Feature-Flag", "disabled")
        }
        
        middleware(next).ServeHTTP(w, r)
    })
}
```

### Áµ±Âêà‰æãÔºöÈ´òÂ∫¶„Å™„Éü„Éâ„É´„Ç¶„Çß„Ç¢„É´„Éº„Çø„Éº

```go
type AdvancedMiddlewareRouter struct {
    conditionalMiddleware *ConditionalMiddleware
    dynamicConfig        *DynamicMiddlewareConfig
    abTests              map[string]*ABTestMiddleware
    featureFlags         map[string]*FeatureFlaggedMiddleware
}

func NewAdvancedMiddlewareRouter() *AdvancedMiddlewareRouter {
    router := &AdvancedMiddlewareRouter{
        conditionalMiddleware: NewConditionalMiddleware(),
        dynamicConfig:        NewDynamicMiddlewareConfig(),
        abTests:              make(map[string]*ABTestMiddleware),
        featureFlags:         make(map[string]*FeatureFlaggedMiddleware),
    }
    
    // Âü∫Êú¨ÁöÑ„Å™„É´„Éº„É´„ÇíË®≠ÂÆö
    router.setupDefaultRules()
    
    return router
}

func (amr *AdvancedMiddlewareRouter) setupDefaultRules() {
    // API „Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åß„ÅØË™çË®º„ÅåÂøÖË¶Å
    amr.conditionalMiddleware.AddRule(
        func(r *http.Request) bool {
            return strings.HasPrefix(r.URL.Path, "/api/")
        },
        AuthenticationMiddleware,
    )
    
    // ÁÆ°ÁêÜËÄÖ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åß„ÅØÁÆ°ÁêÜËÄÖÊ®©Èôê„ÅåÂøÖË¶Å
    amr.conditionalMiddleware.AddRule(
        func(r *http.Request) bool {
            return strings.HasPrefix(r.URL.Path, "/admin/")
        },
        AdminOnlyMiddleware,
    )
    
    // ÈñãÁô∫Áí∞Â¢É„Åß„ÅÆ„Åø„Éá„Éê„ÉÉ„Ç∞„Éü„Éâ„É´„Ç¶„Çß„Ç¢
    amr.conditionalMiddleware.AddRule(
        func(r *http.Request) bool {
            return os.Getenv("ENV") == "development"
        },
        DebugMiddleware,
    )
    
    // HTTPSÂøÖÈ†à„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà
    amr.conditionalMiddleware.AddRule(
        func(r *http.Request) bool {
            sensitivePathPattern := `^/(payment|auth|admin)/`
            matched, _ := regexp.MatchString(sensitivePathPattern, r.URL.Path)
            return matched
        },
        HTTPSRequiredMiddleware,
    )
}

func (amr *AdvancedMiddlewareRouter) AddABTest(name string, variantRatio float64,
    variant, control func(http.Handler) http.Handler) {
    amr.abTests[name] = NewABTestMiddleware(name, variantRatio, variant, control)
}

func (amr *AdvancedMiddlewareRouter) AddFeatureFlag(flagName string, client FeatureFlagClient,
    middleware, fallback func(http.Handler) http.Handler) {
    amr.featureFlags[flagName] = NewFeatureFlaggedMiddleware(flagName, client, middleware, fallback)
}

func (amr *AdvancedMiddlewareRouter) Handler(next http.Handler) http.Handler {
    // „Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÉÅ„Çß„Éº„É≥„ÇíÊßãÁØâ
    handler := next
    
    // Ê©üËÉΩ„Éï„É©„Ç∞‰ªò„Åç„Éü„Éâ„É´„Ç¶„Çß„Ç¢
    for _, ffm := range amr.featureFlags {
        handler = ffm.Apply(handler)
    }
    
    // A/B„ÉÜ„Çπ„Éà„Éü„Éâ„É´„Ç¶„Çß„Ç¢
    for _, abm := range amr.abTests {
        handler = abm.Apply(handler)
    }
    
    // Êù°‰ª∂‰ªò„Åç„Éü„Éâ„É´„Ç¶„Çß„Ç¢
    handler = amr.conditionalMiddleware.Apply(handler)
    
    return handler
}
```

## üìù Ë™≤È°å (The Problem)

‰ª•‰∏ã„ÅÆÊ©üËÉΩ„ÇíÊåÅ„Å§È´òÂ∫¶„Å™Conditional Middleware„Ç∑„Çπ„ÉÜ„É†„ÇíÂÆüË£Ö„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö

### 1. ConditionalMiddleware „ÅÆÂÆüË£Ö

```go
type ConditionalMiddleware struct {
    rules []MiddlewareRule
}

type MiddlewareRule struct {
    Name       string
    Condition  func(*http.Request) bool
    Middleware func(http.Handler) http.Handler
    Priority   int
}
```

### 2. ÂøÖË¶Å„Å™Ê©üËÉΩ

- **„É´„Éº„É´„Éô„Éº„ÇπÊù°‰ª∂Âà§ÂÆö**: „Éë„Çπ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ„ÄÅ„Éò„ÉÉ„ÉÄ„Éº„ÄÅ„É¶„Éº„Ç∂„ÉºÂ±ûÊÄß„Åß„ÅÆÊù°‰ª∂ÂàÜÂ≤ê
- **ÂÑ™ÂÖàÂ∫¶Âà∂Âæ°**: „Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÅÆÂÆüË°åÈ†ÜÂ∫èÂà∂Âæ°
- **ÂãïÁöÑË®≠ÂÆöÊõ¥Êñ∞**: ÂÆüË°åÊôÇ„Åß„ÅÆÊù°‰ª∂„Éª„Éü„Éâ„É´„Ç¶„Çß„Ç¢Ë®≠ÂÆöÂ§âÊõ¥
- **A/B„ÉÜ„Çπ„ÉàÂØæÂøú**: „É¶„Éº„Ç∂„Éº„Çª„Ç∞„É°„É≥„ÉàÂà•Âá¶ÁêÜÂàÜÂ≤ê
- **Ê©üËÉΩ„Éï„É©„Ç∞Áµ±Âêà**: „Éï„Ç£„Éº„ÉÅ„É£„Éº„Éï„É©„Ç∞„Å´„Çà„ÇãÊ©üËÉΩON/OFF

### 3. Êù°‰ª∂Âºè„ÅÆÂÆüË£Ö

- Path Pattern Matching
- HTTP Method Filtering  
- Header Value Checking
- User Role/Permission Based
- Time-based Conditions
- Geographic Conditions

### 4. „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ

- Êù°‰ª∂Ë©ï‰æ°„ÅÆÂäπÁéáÂåñ
- „Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÉÅ„Çß„Éº„É≥ÊßãÁØâ„Ç≥„Çπ„ÉàÂâäÊ∏õ
- „É°„É¢„É™‰ΩøÁî®ÈáèÊúÄÈÅ©Âåñ

### 5. Áõ£Ë¶ñÊ©üËÉΩ

- „Éü„Éâ„É´„Ç¶„Çß„Ç¢ÂÆüË°å„É°„Éà„É™„ÇØ„Çπ
- Êù°‰ª∂„Éû„ÉÉ„ÉÅ„É≥„Ç∞Áµ±Ë®à
- „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁõ£Ë¶ñ

## ‚úÖ ÊúüÂæÖ„Åï„Çå„ÇãÊåôÂãï (Expected Behavior)

ÂÆüË£Ö„ÅåÊ≠£„Åó„ÅèÂÆå‰∫Ü„Åô„Çã„Å®„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™„ÉÜ„Çπ„ÉàÁµêÊûú„ÅåÂæó„Çâ„Çå„Åæ„ÅôÔºö

```bash
$ go test -v
=== RUN   TestConditionalMiddleware_BasicRules
    main_test.go:45: Path-based rule applied correctly
--- PASS: TestConditionalMiddleware_BasicRules (0.01s)

=== RUN   TestConditionalMiddleware_Priority
    main_test.go:65: Middleware executed in correct priority order
--- PASS: TestConditionalMiddleware_Priority (0.01s)

=== RUN   TestConditionalMiddleware_DynamicUpdate
    main_test.go:85: Dynamic rule update working correctly
--- PASS: TestConditionalMiddleware_DynamicUpdate (0.02s)

=== RUN   TestABTestMiddleware
    main_test.go:105: A/B test variant distribution correct
--- PASS: TestABTestMiddleware (0.03s)

=== RUN   TestFeatureFlagMiddleware
    main_test.go:125: Feature flag toggle working correctly
--- PASS: TestFeatureFlagMiddleware (0.01s)

PASS
ok      day18-conditional-middleware   0.156s
```

## üí° „Éí„É≥„Éà (Hints)

ÂÆüË£Ö„Å´Ë©∞„Åæ„Å£„ÅüÂ†¥Âêà„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ„Éí„É≥„Éà„ÇíÂèÇËÄÉ„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö

### Âü∫Êú¨ÁöÑ„Å™Êù°‰ª∂Âà§ÂÆö

```go
func PathMatches(pattern string) func(*http.Request) bool {
    return func(r *http.Request) bool {
        matched, _ := regexp.MatchString(pattern, r.URL.Path)
        return matched
    }
}

func MethodIs(methods ...string) func(*http.Request) bool {
    return func(r *http.Request) bool {
        for _, method := range methods {
            if r.Method == method {
                return true
            }
        }
        return false
    }
}

func HasHeader(key, value string) func(*http.Request) bool {
    return func(r *http.Request) bool {
        return r.Header.Get(key) == value
    }
}
```

### „Éü„Éâ„É´„Ç¶„Çß„Ç¢ÂÆüË°åÈ†ÜÂà∂Âæ°

```go
func (cm *ConditionalMiddleware) sortRulesByPriority() {
    sort.Slice(cm.rules, func(i, j int) bool {
        return cm.rules[i].Priority > cm.rules[j].Priority
    })
}
```

### ÂãïÁöÑË®≠ÂÆöÊõ¥Êñ∞

```go
func (cm *ConditionalMiddleware) UpdateRule(name string, rule MiddlewareRule) {
    cm.mu.Lock()
    defer cm.mu.Unlock()
    
    for i, existingRule := range cm.rules {
        if existingRule.Name == name {
            cm.rules[i] = rule
            cm.sortRulesByPriority()
            return
        }
    }
    
    cm.rules = append(cm.rules, rule)
    cm.sortRulesByPriority()
}
```

## üöÄ Áô∫Â±ïË™≤È°å (Advanced Challenges)

Âü∫Êú¨ÂÆüË£Ö„ÅåÂÆå‰∫Ü„Åó„Åü„Çâ„ÄÅ‰ª•‰∏ã„ÅÆÁô∫Â±ïÁöÑ„Å™Ê©üËÉΩ„Å´„ÇÇ„ÉÅ„É£„É¨„É≥„Ç∏„Åó„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑÔºö

1. **„Éó„É©„Ç∞„Ç§„É≥„Ç∑„Çπ„ÉÜ„É†**: Â§ñÈÉ®„Åã„Çâ„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÇíÂãïÁöÑ„É≠„Éº„Éâ
2. **Ê©üÊ¢∞Â≠¶ÁøíÁµ±Âêà**: „É¶„Éº„Ç∂„ÉºË°åÂãï„Éô„Éº„Çπ„ÅÆÂãïÁöÑ„É´„Éº„ÉÜ„Ç£„É≥„Ç∞
3. **ÂàÜÊï£Ë®≠ÂÆöÁÆ°ÁêÜ**: Consul/etcd„Åß„ÅÆË®≠ÂÆöÂêåÊúü
4. **„É™„Ç¢„É´„Çø„Ç§„É†Ëß£Êûê**: „Éü„Éâ„É´„Ç¶„Çß„Ç¢ÂÆüË°å„ÅÆÂèØË¶ñÂåñ
5. **„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Çπ„Ç≠„É£„É≥**: Êù°‰ª∂Âºè„ÅÆÂÆâÂÖ®ÊÄßÊ§úË®º

Conditional Middleware„ÅÆÂÆüË£Ö„ÇíÈÄö„Åò„Å¶„ÄÅÊüîËªü„ÅßÊã°ÂºµÂèØËÉΩ„Å™Web„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅÆÊßãÁØâÊâãÊ≥ï„ÇíÁøíÂæó„Åó„Åæ„Åó„Çá„ÅÜÔºÅ